["```go\n$cond\n```", "```go\n$ifNull\n```", "```go\n$switch\n```", "```go\n{\n   $convert:\n      {\n         input: <expression>,\n         to: <type expression>,\n         onError: <expression>,  // Optional.\n         onNull: <expression>    // Optional.\n      } }\n\n```", "```go\n$convert: { input: \"true\", to: \"bool\" } \n```", "```go\n{ $toBool: \"true\" }\n```", "```go\n> db.blocks.findOne()\n{\n\"_id\" : ObjectId(\"595368fbcedea89d3f4fb0ca\"),\n\"number_transactions\" : 28,\n\"timestamp\" : NumberLong(\"1498324744877\"),\n\"gas_used\" : 4694483,\n\"number_internal_transactions\" : 4,\n\"block_hash\" : \"0x89d235c4e2e4e4978440f3cc1966f1ffb343b9b5cfec9e5cebc331fb810bded3\",\n\"difficulty\" : NumberLong(\"882071747513072\"),\n\"block_height\" : 3923788\n}\n```", "```go\n> db.transactions.findOne()\n{\n\"_id\" : ObjectId(\"59535748cedea89997e8385a\"),\n\"from\" : \"0x3c540be890df69eca5f0099bbedd5d667bd693f3\",\n\"txfee\" : 28594,\n\"timestamp\" : ISODate(\"2017-06-06T11:23:10Z\"),\n\"value\" : 0,\n\"to\" : \"0x4b9e0d224dabcc96191cace2d367a8d8b75c9c81\",\n\"txhash\" : \"0xf205991d937bcb60955733e760356070319d95131a2d9643e3c48f2dfca39e77\",\n\"block\" : 3923794\n}\n```", "```go\n   def top_ten_addresses_from(self):\n       pipeline = [\n           {\"$group\": {\"_id\": \"$from\", \"count\": {\"$sum\": 1}}},\n           {\"$sort\": SON([(\"count\", -1)])},\n           {\"$limit\": 10},\n       ]\n       result = self.collection.aggregate(pipeline)\n       for res in result:\n           print(res)\n```", "```go\n{u'count': 38, u'_id': u'miningpoolhub_1'}\n{u'count': 31, u'_id': u'Ethermine'}\n{u'count': 30, u'_id': u'0x3c540be890df69eca5f0099bbedd5d667bd693f3'}\n{u'count': 27, u'_id': u'0xb42b20ddbeabdc2a288be7ff847ff94fb48d2579'}\n{u'count': 25, u'_id': u'ethfans.org'}\n{u'count': 16, u'_id': u'Bittrex'}\n{u'count': 8, u'_id': u'0x009735c1f7d06faaf9db5223c795e2d35080e826'}\n{u'count': 8, u'_id': u'Oraclize'}\n{u'count': 7, u'_id': u'0x1151314c646ce4e0efd76d1af4760ae66a9fe30f'}\n{u'count': 7, u'_id': u'0x4d3ef0e8b49999de8fa4d531f07186cc3abe3d6e'}\n```", "```go\n   def top_ten_addresses_to(self):\n       pipeline = [\n           {\"$group\": {\"_id\": \"$to\", \"count\": {\"$sum\": 1}}},\n           {\"$sort\": SON([(\"count\", -1)])},\n           {\"$limit\": 10},\n       ]\n       result = self.collection.aggregate(pipeline)\n       for res in result:\n           print(res)\n```", "```go\n{u'count': 33, u'_id': u'0x6090a6e47849629b7245dfa1ca21d94cd15878ef'}\n{u'count': 30, u'_id': u'0x4b9e0d224dabcc96191cace2d367a8d8b75c9c81'}\n{u'count': 25, u'_id': u'0x69ea6b31ef305d6b99bb2d4c9d99456fa108b02a'}\n{u'count': 23, u'_id': u'0xe94b04a0fed112f3664e45adb2b8915693dd5ff3'}\n{u'count': 22, u'_id': u'0x8d12a197cb00d4747a1fe03395095ce2a5cc6819'}\n{u'count': 18, u'_id': u'0x91337a300e0361bddb2e377dd4e88ccb7796663d'}\n{u'count': 13, u'_id': u'0x1c3f580daeaac2f540c998c8ae3e4b18440f7c45'}\n{u'count': 12, u'_id': u'0xeef274b28bd40b717f5fea9b806d1203daad0807'}\n{u'count': 9, u'_id': u'0x96fc4553a00c117c5b0bed950dd625d1c16dc894'}\n{u'count': 9, u'_id': u'0xd43d09ec1bc5e57c8f3d0c64020d403b04c7f783'}\n```", "```go\n   def average_value_per_transaction(self):\n       pipeline = [\n           {\"$group\": {\"_id\": \"value\", \"averageValues\": {\"$avg\": \"$value\"}, \"stdDevValues\": {\"$stdDevPop\": \"$value\"}}},\n       ]\n       result = self.collection.aggregate(pipeline)\n       for res in result:\n           print(res)\n```", "```go\n{u'averageValues': 5.227238976440972, u'_id': u'value', u'stdDevValues': 38.90322689649576}\n```", "```go\n   def average_fee_per_transaction(self):\n       pipeline = [\n           {\"$group\": {\"_id\": \"value\", \"averageFees\": {\"$avg\": \"$txfee\"}, \"stdDevValues\": {\"$stdDevPop\": \"$txfee\"}}},\n       ]\n       result = self.collection.aggregate(pipeline)\n       for res in result:\n           print(res)\n```", "```go\n{u'_id': u'value', u'averageFees': 320842.0729166667, u'stdDevValues': 1798081.7305142984} \n```", "```go\n   def active_hour_of_day_transactions(self):\n       pipeline = [\n           {\"$group\": {\"_id\": {\"$hour\": \"$timestamp\"}, \"transactions\": {\"$sum\": 1}}},\n           {\"$sort\": SON([(\"transactions\", -1)])},\n           {\"$limit\": 1},\n       ]\n       result = self.collection.aggregate(pipeline)\n       for res in result:\n           print(res)\n```", "```go\n{u'_id': 11, u'transactions': 34} \n```", "```go\n  def active_hour_of_day_values(self):\n pipeline = [\n {\"$group\": {\"_id\": {\"$hour\": \"$timestamp\"}, \"transaction_values\": {\"$sum\": \"$value\"}}},\n {\"$sort\": SON([(\"transactions\", -1)])},\n {\"$limit\": 1},\n ]\n result = self.collection.aggregate(pipeline)\n for res in result:\n print(res)\n```", "```go\n{u'transaction_values': 33.17773841, u'_id': 20} \n```", "```go\n   def active_day_of_week_transactions(self):\n       pipeline = [\n           {\"$group\": {\"_id\": {\"$dayOfWeek\": \"$timestamp\"}, \"transactions\": {\"$sum\": 1}}},\n           {\"$sort\": SON([(\"transactions\", -1)])},\n           {\"$limit\": 1},\n       ]\n       result = self.collection.aggregate(pipeline)\n       for res in result:\n           print(res)\n\n```", "```go\n{u'_id': 3, u'transactions': 92} \n```", "```go\n  def active_day_of_week_values(self):\n       pipeline = [\n           {\"$group\": {\"_id\": {\"$dayOfWeek\": \"$timestamp\"}, \"transaction_values\": {\"$sum\": \"$value\"}}},\n           {\"$sort\": SON([(\"transactions\", -1)])},\n           {\"$limit\": 1},\n       ]\n```", "```go\n       result = self.collection.aggregate(pipeline)\n for res in result:\n print(res)\n```", "```go\n\n {u'transaction_values': 547.62439312, u'_id': 2} \n```", "```go\n   def average_number_transactions_total_block(self):\n       pipeline = [\n           {\"$group\": {\"_id\": \"average_transactions_per_block\", \"count\": {\"$avg\": \"$number_transactions\"}}},\n       ]\n       result = self.collection.aggregate(pipeline)\n       for res in result:\n           print(res)\n```", "```go\n {u'count': 39.458333333333336, u'_id': u'average_transactions_per_block'}\n\n```", "```go\n  def average_number_transactions_internal_block(self):\n       pipeline = [\n           {\"$group\": {\"_id\": \"average_transactions_internal_per_block\", \"count\": {\"$avg\": \"$number_internal_transactions\"}}},\n       ]\n       result = self.collection.aggregate(pipeline)\n       for res in result:\n           print(res)\n```", "```go\n{u'count': 8.0, u'_id': u'average_transactions_internal_per_block'}\n```", "```go\ndef average_gas_block(self):\n       pipeline = [\n           {\"$group\": {\"_id\": \"average_gas_used_per_block\",\n                       \"count\": {\"$avg\": \"$gas_used\"}}},\n       ]\n       result = self.collection.aggregate(pipeline)\n       for res in result:\n           print(res)\n```", "```go\n{u'count': 2563647.9166666665, u'_id': u'average_gas_used_per_block'} \n```", "```go\n  def average_difficulty_block(self):\n       pipeline = [\n           {\"$group\": {\"_id\": \"average_difficulty_per_block\",\n                       \"count\": {\"$avg\": \"$difficulty\"}, \"stddev\": {\"$stdDevPop\": \"$difficulty\"}}},\n       ]\n       result = self.collection.aggregate(pipeline)\n       for res in result:\n           print(res)\n```", "```go\n{u'count': 881676386932100.0, u'_id': u'average_difficulty_per_block', u'stddev': 446694674991.6385} \n```", "```go\n{\n \"_id\" : ObjectId(\"59554977cedea8f696a416dd\"),\n \"to\" : \"0x4b9e0d224dabcc96191cace2d367a8d8b75c9c81\",\n \"txhash\" : \"0xf205991d937bcb60955733e760356070319d95131a2d9643e3c48f2dfca39e77\",\n \"from\" : \"0x3c540be890df69eca5f0099bbedd5d667bd693f3\",\n \"block\" : 3923794,\n \"txfee\" : 28594,\n \"timestamp\" : ISODate(\"2017-06-10T09:59:35Z\"),\n \"tags\" : [\n \"scam\",\n \"ico\"\n ],\n \"value\" : 0\n }\n```", "```go\ndef scam_or_ico_aggregation(self):\n pipeline = [\n {\"$match\": {\"timestamp\": {\"$gte\": datetime.datetime(2017,6,1), \"$lte\": datetime.datetime(2017,7,1)}}},\n {\"$project\": {\n \"to\": 1,\n \"txhash\": 1,\n \"from\": 1,\n \"block\": 1,\n \"txfee\": 1,\n \"tags\": 1,\n \"value\": 1,\n \"report_period\": \"June 2017\",\n \"_id\": 0,\n }\n\n },\n {\"$unwind\": \"$tags\"},\n {\"$out\": \"scam_ico_documents\"}\n ]\n result = self.collection.aggregate(pipeline)\n for res in result:\n print(res)\n```", "```go\n{u'from': u'miningpoolhub_1', u'tags': u'scam', u'report_period': u'June 2017', u'value': 0.52415349, u'to': u'0xdaf112bcbd38d231b1be4ae92a72a41aa2bb231d', u'txhash': u'0xe11ea11df4190bf06cbdaf19ae88a707766b007b3d9f35270cde37ceccba9a5c', u'txfee': 21.0, u'block': 3923785}\n```", "```go\n{\n \"_id\" : ObjectId(\"5955533be9ec57bdb074074e\"),\n \"to\" : \"0x4b9e0d224dabcc96191cace2d367a8d8b75c9c81\",\n \"txhash\" : \"0xf205991d937bcb60955733e760356070319d95131a2d9643e3c48f2dfca39e77\",\n \"from\" : \"0x3c540be890df69eca5f0099bbedd5d667bd693f3\",\n \"block\" : 3923794,\n \"txfee\" : 28594,\n \"tags\" : \"scam\",\n \"value\" : 0,\n \"report_period\" : \"June 2017\"\n }\n```", "```go\n{\n \"_id\" : ObjectId(\"5955510e14ae9238fe76d7f0\"),\n \"scam_address\" : \"0x3c540be890df69eca5f0099bbedd5d667bd693f3\",\n Email_address\": example@scammer.com\"\n }\n```", "```go\ndef scam_add_information(self):\n client = MongoClient()\n db = client.mongo_book\n scam_collection = db.scam_ico_documents\n pipeline = [\n {\"$lookup\": {\"from\": \"scam_details\", \"localField\": \"from\", \"foreignField\": \"scam_address\", \"as\": \"scam_details\"}},\n {\"$match\": {\"scam_details\": { \"$ne\": [] }}},\n {\"$out\": \"scam_ico_documents_extended\"}\n ]\n result = scam_collection.aggregate(pipeline)\n for res in result:\n print(res)\n```", "```go\n> db.scam_ico_documents_extended.findOne()\n {\n \"_id\" : ObjectId(\"5955533be9ec57bdb074074e\"),\n \"to\" : \"0x4b9e0d224dabcc96191cace2d367a8d8b75c9c81\",\n \"txhash\" : \"0xf205991d937bcb60955733e760356070319d95131a2d9643e3c48f2dfca39e77\",\n \"from\" : \"0x3c540be890df69eca5f0099bbedd5d667bd693f3\",\n \"block\" : 3923794,\n \"txfee\" : 28594,\n \"tags\" : \"scam\",\n \"value\" : 0,\n \"report_period\" : \"June 2017\",\n \"scam_details_data\" : [\n {\n \"_id\" : ObjectId(\"5955510e14ae9238fe76d7f0\"),\n \"scam_address\" : \"0x3c540be890df69eca5f0099bbedd5d667bd693f3\",\n email_address\": example@scammer.com\"\n }]}\n```"]