- en: Chapter 13. Synchronizing Data and Supporting Replication
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第13章。同步数据和支持复制
- en: In this chapter, we will cover two features that were released in phpMyAdmin
    3.3.0\. The first feature is the ability to synchronize databases, and was asked
    for by developers who work on more than one server. The second feature permits
    the management of MySQL replication, which is used in environments where performance
    and data security are important. These features are somewhat related because we
    usually need to synchronize the database to a slave server when setting it up
    in a replication process.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍phpMyAdmin 3.3.0版本中发布的两个功能。第一个功能是同步数据库的能力，这是开发人员要求的，他们在多个服务器上工作。第二个功能允许管理MySQL复制，在性能和数据安全性重要的环境中使用。这些功能有些相关，因为在设置复制过程时，通常需要将数据库同步到从服务器。
- en: Synchronizing data and structure
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 同步数据和结构
- en: In earlier phpMyAdmin versions, it was possible to achieve some synchronization
    of the structure and data between two databases on the same server or on different
    servers, but this required manual operations. It was (and still is) possible to
    export structure and/or data from one database and import in another one. We can
    even visually compare the structure of two tables and adjust them according to
    our needs. However, comparing the two databases to ascertain what needs to be
    imported had to be done with the developer's own eyeballs. Moreover, differences
    in structure between the databases were not taken into account, possibly resulting
    in errors when a column was missing in the target table.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在较早的phpMyAdmin版本中，可以在同一服务器或不同服务器上的两个数据库之间实现一些结构和数据的同步，但这需要手动操作。可以从一个数据库导出结构和/或数据，然后导入到另一个数据库。我们甚至可以直观地比较两个表的结构，并根据需要进行调整。然而，必须由开发人员自己用眼睛比较两个数据库以确定需要导入的内容。此外，数据库之间的结构差异没有被考虑在内，可能导致目标表中缺少列时出现错误。
- en: The **synchronize** feature of phpMyAdmin permits much flexibility, by taking
    care of the initial comparison process and, of course, by performing the synchronization
    itself. We will first discuss the reasons for synchronizing, and then examine
    and experiment with all the steps involved.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: phpMyAdmin的**同步**功能非常灵活，通过处理初始比较过程，当然也通过执行同步本身。我们将首先讨论同步的原因，然后检查并实验涉及的所有步骤。
- en: Goals of synchronization
  id: totrans-5
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 同步的目标
- en: Although the reasons for wanting to synchronize two databases may be many, we
    can group them into the following categories.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管想要同步两个数据库的原因可能很多，但我们可以将它们分为以下几类。
- en: Moving between the development and production servers
  id: totrans-7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在开发和生产服务器之间移动
- en: A sound database development strategy includes performing development and testing
    on a server that is distinct from the production one. If having a separate development
    server is not an option, having at least a distinct development database is encouraged.
    Over time, differences in structure between test and production environments build
    up, and this is normal. For example, a column may be added in the test version,
    or character column may be enlarged. The synchronize feature permits us to first
    see the differences and then apply them to production if they make sense.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 一个良好的数据库开发策略包括在与生产服务器不同的服务器上进行开发和测试。如果没有单独的开发服务器，至少鼓励使用单独的开发数据库。随着时间的推移，测试和生产环境之间的结构差异会积累，这是正常的。例如，测试版本可能会添加一个列，或者字符列可能会被扩大。同步功能允许我们首先查看差异，然后根据需要将其应用到生产环境。
- en: Moving data sometimes needs to be done the other way around, for example, to
    populate a test database with real production data in order to measure performance.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 有时需要以相反的方式移动数据，例如，为了衡量性能而将真实生产数据填充到测试数据库中。
- en: Collaboration between database designers
  id: totrans-10
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 数据库设计师之间的协作
- en: Due to the easy manner in which a MySQL test server can be put in place, the
    situation might arise where each member of a development team has his own server
    (or his own copy of the database) in which he develops some aspect of a project.
    When the time comes to reconcile everyone's changes for the same table, the synchronize
    feature is invaluable.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 由于MySQL测试服务器可以轻松设置，可能会出现这样的情况，即开发团队的每个成员都有自己的服务器（或自己的数据库副本），在其中开发项目的某个方面。当需要协调每个人对同一表的更改时，同步功能是非常宝贵的。
- en: Preparing for replication
  id: totrans-12
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 为复制做准备
- en: 'MySQL supports asynchronous replication between a master server and one or
    many slave servers. This data replication is termed "asynchronous" because the
    connection between master and slaves does not need to be permanent. However, to
    put a replication process in action (and assuming that the master already contains
    some data), one needs to copy all the data over to the slaves. A suggestion to
    accomplish this copy is given in the MySQL manual that can found at [http://dev.mysql.com/doc/refman/5.1/en/replication-howto.html](http://dev.mysql.com/doc/refman/5.1/en/replication-howto.html),
    and is mentioned as follows:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL支持主服务器和一个或多个从服务器之间的异步复制。这种数据复制被称为“异步”，因为主服务器和从服务器之间的连接不需要是永久的。然而，要启动复制过程（假设主服务器已经包含一些数据），就需要将所有数据复制到从服务器上。MySQL手册中提供了一个完成此复制的建议，可以在[http://dev.mysql.com/doc/refman/5.1/en/replication-howto.html](http://dev.mysql.com/doc/refman/5.1/en/replication-howto.html)找到，如下所述：
- en: '"If you already have data on your master and you want to use it to synchronize
    your slave, you will need to create a data snapshot. You can create a snapshot
    using `mysqldump` (...)"'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: “如果您的主服务器已经有数据，并且您想使用它来同步您的从服务器，您需要创建一个数据快照。您可以使用`mysqldump`来创建一个快照（...）”
- en: However, this requires using a command-line tool that is not always possible
    depending on the hosting options. Besides, some parts of the database may already
    exist on the slave; therefore, the synchronize feature comes in handy because
    it's integrated into phpMyAdmin, and also because it takes care of the comparison
    phase.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这需要使用一个命令行工具，这取决于托管选项并不总是可能的。此外，数据库的某些部分可能已经存在于从属数据库；因此，同步功能非常方便，因为它集成到了phpMyAdmin中，并且它负责比较阶段。
- en: Over viewing the synchronization process
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 查看同步过程
- en: The important principle is that synchronization is done from a source database
    to a target database. During this operation, the source database remains unchanged.
    It's up to us to correctly identify which database is the source and which one
    is the target (and will be possibly modified).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的原则是同步是从源数据库到目标数据库完成的。在此操作期间，源数据库保持不变。我们需要正确识别哪个数据库是源数据库，哪个是目标数据库（可能会被修改）。
- en: 'The whole process is subdivided into steps which can be stopped at any stage:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 整个过程被细分为可以在任何阶段停止的步骤：
- en: Server and database choice
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务器和数据库选择
- en: Comparison
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 比较
- en: Full or selective synchronization
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 完整或选择性同步
- en: 'We could elect to stop the process for one of the following reasons:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以选择出于以下原因之一停止该过程：
- en: We don't have the necessary credentials to connect to one of the servers
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们没有连接到其中一个服务器所需的凭据
- en: We see discrepancies between two databases and are not ready to synchronize
    because further research needs to be done
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们发现两个数据库之间存在差异，并且还没有准备好进行同步，因为需要进一步研究
- en: We notice after the comparison phase that the target database is adequately
    synchronized
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们在比较阶段之后注意到目标数据库已经充分同步
- en: Before performing synchronization, we will put the necessary elements in place.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在执行同步之前，我们将准备好必要的元素。
- en: Preparing for the synchronization exercise
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 为同步练习做准备
- en: 'As we will play with only the `author` and `book` tables, this exercise will
    assume that there are no other tables in the `marc_book` database. We start by
    copying the `marc_book` database to `marc_book_dev` (refer to [Chapter 9](ch09.html
    "Chapter 9. Performing Table and Database Operations") for the exact method for
    doing this).Then we open the `marc_book_dev` database and perform the following
    actions:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们只会操作`author`和`book`表，因此本练习将假定`marc_book`数据库中没有其他表。我们首先将`marc_book`数据库复制到`marc_book_dev`（有关如何执行此操作的确切方法，请参阅[第9章](ch09.html
    "第9章。执行表和数据库操作")）。然后我们打开`marc_book_dev`数据库并执行以下操作：
- en: Delete the `book` table
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 删除`book`表
- en: Delete one row of the `author` table
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从`author`表中删除一行
- en: Change the type of the `name` column from `VARCHAR(30)` to `VARCHAR(29)`
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将`name`列的类型从`VARCHAR(30)`更改为`VARCHAR(29)`
- en: Delete the `phone` column from the `author` table
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从`author`表中删除`phone`列
- en: '[Chapter 5](ch05.html "Chapter 5. Changing Data and Structure") covers how
    to perform the previous actions.'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '[第5章](ch05.html "第5章。更改数据和结构")介绍了如何执行前面的操作。'
- en: Choosing source and target servers and databases
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 选择源和目标服务器和数据库
- en: The initial Synchronize page is displayed via the **Synchronize** menu tab in
    `Server` view. Please note that this is the only place where this menu is available.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 通过“服务器”视图中的**同步**菜单选项显示初始同步页面。请注意，这是唯一可以使用该菜单的地方。
- en: 'The first panel permits us to connect to servers (if needed) and to pick the
    correct database. If the `$cfg[''AllowArbitraryServer'']` parameter is set to
    its default value of `false`, the following panel appears:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个面板允许我们连接到服务器（如果需要）并选择正确的数据库。如果`$cfg['AllowArbitraryServer']`参数设置为其默认值`false`，则会出现以下面板：
- en: '![Choosing source and target servers and databases](img/7782_13_01.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![选择源和目标服务器和数据库](img/7782_13_01.jpg)'
- en: 'This means that we can only use the servers already defined in `config.inc.php`.
    If arbitrary servers are allowed, we see a different panel, shown in the following
    screenshot:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着我们只能使用在`config.inc.php`中已定义的服务器。如果允许任意服务器，则会看到一个不同的面板，如下面的截图所示：
- en: '![Choosing source and target servers and databases](img/7782_13_02.jpg)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![选择源和目标服务器和数据库](img/7782_13_02.jpg)'
- en: For both the source and target databases, we can select the server location.
    By default, the selector is placed on **Enter manually** and we can enter its
    hostname, port, socket name, username, password, and database name. In most cases,
    the port should be left to the default 3306 and the socket name should be left
    empty. Notice that we are currently connected to a MySQL server (via the normal
    login panel) and this panel could permit us to connect to two more servers.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 对于源数据库和目标数据库，我们可以选择服务器位置。默认情况下，选择器放置在**手动输入**上，我们可以输入其主机名、端口、套接字名称、用户名、密码和数据库名称。在大多数情况下，端口应该保持默认的3306，套接字名称应该保持为空。请注意，我们当前连接到一个MySQL服务器（通过正常的登录面板），这个面板可以让我们连接到另外两个服务器。
- en: Another choice for server location is **Current connection**. This refers to
    the server on which we are connected for normal phpMyAdmin operations; its name
    is displayed at the top of the main panel. Should we choose this, a JavaScript-enabled
    browser hides all choices except for the database name (connection credentials
    are unnecessary in this situation) and a selector becomes available, showing all
    of the databases to which we have access.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器位置的另一个选择是**当前连接**。这指的是我们连接的用于正常phpMyAdmin操作的服务器；其名称显示在主面板顶部。如果我们选择这个选项，启用JavaScript的浏览器会隐藏除了数据库名称之外的所有选项（在这种情况下，连接凭据是不必要的），并且会出现一个选择器，显示我们可以访问的所有数据库。
- en: It's perfectly possible to pick the same server on both the source and target
    sides; however, we would at least choose a source database different to the target
    one in this case. Another common case is to pick the current server and some database
    as the source, and a remote server with the same database as the target, assuming
    that the remote server is the production one and that both servers hold a database
    with the same name.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在源和目标两侧选择相同的服务器是完全可能的；然而，在这种情况下，我们至少会选择一个不同于目标的源数据库。另一个常见情况是选择当前服务器和某个数据库作为源，以及具有相同数据库的远程服务器作为目标，假设远程服务器是生产服务器，并且两个服务器都拥有同名的数据库。
- en: 'For this exercise, let us pick **Current connection** for both source and target
    servers; we can then choose `marc_book` as the source database and `marc_book_dev`
    as the target one, as shown in the following screenshot:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，让我们为源和目标服务器都选择**当前连接**；然后我们可以选择`marc_book`作为源数据库，`marc_book_dev`作为目标数据库，如下面的截图所示：
- en: '![Choosing source and target servers and databases](img/7782_13_03.jpg)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![选择源和目标服务器和数据库](img/7782_13_03.jpg)'
- en: After clicking on **Go**, phpMyAdmin attempts to connect to the servers if needed.
    At this point, a connection error message may be displayed. However, the connection
    should hopefully succeed and the program will start comparing both databases and
    then show us the results.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**Go**后，phpMyAdmin尝试连接服务器（如果需要）。此时可能会显示连接错误消息。但是，连接应该会成功，程序将开始比较两个数据库，然后显示结果。
- en: Analyzing comparison results
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分析比较结果
- en: 'The comparison results panel contains three sections. The first section displays
    the structure and data differences, and contains icons that will be used to initiate
    a selective synchronization:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 比较结果面板包含三个部分。第一部分显示了结构和数据的差异，并包含将用于启动选择性同步的图标：
- en: '![Analyzing comparison results](img/7782_13_04.jpg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![分析比较结果](img/7782_13_04.jpg)'
- en: As depicted in the upper part, the red **S** icon triggers structure synchronization,
    whereas the green **D** icon is for data synchronization. Then, for each table,
    we get a rundown of the differences. The central **Difference** column would be
    empty in the case of identical structure and data for the corresponding table.
    Here we see a red **S** and a green **D** for both tables, but the reason is not
    the same for each table.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 如上部所示，红色的**S**图标触发结构同步，而绿色的**D**图标用于数据同步。然后，对于每个表，我们得到差异的摘要。在相应表的结构和数据相同的情况下，中央的**差异**列将为空。在这里，我们看到两个表的红色**S**和绿色**D**，但原因并不相同。
- en: 'The middle part shows the actions that are scheduled as part of the synchronization
    process (there are currently none, as can be seen in the following screenshot):'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 中部显示了作为同步过程一部分的计划操作（目前没有，如下面的截图所示）：
- en: '![Analyzing comparison results](img/7782_13_05.jpg)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![分析比较结果](img/7782_13_05.jpg)'
- en: 'The lower part contains a checkbox **(Would you like to delete all the previous
    rows from target tables?)** and two action buttons. We will see their purpose
    in the following sections:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 下部包含一个复选框**(您是否要删除目标表中的所有先前行？)**和两个操作按钮。我们将在以下部分看到它们的用途：
- en: '![Analyzing comparison results](img/7782_13_06.jpg)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![分析比较结果](img/7782_13_06.jpg)'
- en: Please note that the book table has a plus sign (+) next to it on the **Source**
    side, to show that this table is in the source database but not in the target
    database. We even see a **not present** comment for this table on the **Target**
    side. If a table was in the target database but not in the source one, it would
    be marked with a minus sign (-) on the **Target** side.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，书表在**源**一侧有一个加号(+)，表示该表在源数据库中但不在目标数据库中。我们甚至在**目标**一侧看到了对该表的**不存在**注释。如果一个表在目标数据库中但不在源数据库中，它将在**目标**一侧标有减号(-)。
- en: At this point, we can decide that we are satisfied with the comparison and don't
    want to proceed further; in this case, we would just have to continue in phpMyAdmin
    by picking a database and resuming our work. We also have the opportunity of synchronizing
    the databases in one sweep **(complete synchronization)** or to make changes in
    a more granular way **(selective synchronization)**. Let us examine both methods.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，我们可以决定我们对比较结果感到满意，不想继续进行；在这种情况下，我们只需在phpMyAdmin中选择一个数据库并恢复我们的工作。我们还有机会以一次性的方式同步数据库**(完整同步)**，或者以更细粒度的方式进行更改**(选择性同步)**。让我们检查这两种方法。
- en: Performing a complete synchronization
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 执行完整同步
- en: If we don't want to ask ourselves too many questions and just need a complete
    synchronization, we click on **Synchronize Databases**. Note that in this case,
    we don't have to use any red **S** or green **D** icons.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们不想问自己太多问题，只需要完全同步，我们点击**同步数据库**。请注意，在这种情况下，我们不必使用任何红色的**S**或绿色的**D**图标。
- en: Note
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: If one of the target tables contains some rows that are not present in the corresponding
    source table, these will remain in the target tables, unless we tick the **Would
    you like to delete..**. checkbox. This is a safety net to avoid unintended loss
    of data. However, we should select this option if we want an exact synchronization.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 如果目标表中有一些行不在相应的源表中，这些行将保留在目标表中，除非我们勾选**是否要删除..**复选框。这是一个安全网，以避免意外数据丢失。但是，如果我们需要精确同步，我们应该选择此选项。
- en: 'After clicking, we obtain the following message: **Target database has been
    synchronized with source database**. In the lower part of the screen, we see the
    queries that had to be executed in order to achieve this operation. We also get
    a visual confirmation that the databases are now synchronized:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 点击后，我们得到以下消息：**目标数据库已与源数据库同步**。在屏幕的下部，我们看到必须执行的查询以实现此操作。我们还得到了数据库现在已同步的视觉确认：
- en: '![Performing a complete synchronization](img/7782_13_07.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![执行完整同步](img/7782_13_07.jpg)'
- en: Performing a selective synchronization
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 执行选择性同步
- en: If we prefer to be more cautious and receive a preliminary feedback on the actions
    that are about to be done, we can synchronize selected tables. This section assumes
    that the databases are in the same state as at the end of the *Preparing for the
    synchronization exercise* section, covered previously in this chapter.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们更喜欢更谨慎，并且想要对即将执行的操作进行初步反馈，我们可以同步选择的表。本节假设数据库的状态与*为同步练习做准备*部分结束时的状态相同，该部分在本章的前面部分已经涵盖。
- en: 'If we click on the red **S** icon on the line describing the `author` table,
    this **S** icon turns to grey and the middle part of the screen is updated with
    the actions to be done, as shown in the following screenshot:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们点击描述`author`表的行上的红色**S**图标，这个**S**图标会变成灰色，屏幕中部会更新显示要执行的操作，如下面的截图所示：
- en: '![Performing a selective synchronization](img/7782_13_08.jpg)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![执行选择性同步](img/7782_13_08.jpg)'
- en: No real action on the data has been done yet! We still can change our mind by
    clicking on the same icon which would turn back to red, removing the proposed
    changes as depicted in the middle part of the screen.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上还没有对数据进行任何操作！我们仍然可以通过点击相同的图标来改变主意，这会使图中部分所示的建议更改消失，图标也会变回红色。
- en: 'Now we click on the green **D** icon and see another line of proposed changes
    show up, as shown in the following screenshot:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们点击绿色的**D**图标，看到另一行建议的更改出现，如下面的截图所示：
- en: '![Performing a selective synchronization](img/7782_13_09.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![执行选择性同步](img/7782_13_09.jpg)'
- en: A row in the `author` table needs to be inserted because there is one less author
    in the target database. Altogether four rows need to be updated, because we removed
    the `phone` column in the same table.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '`author`表中需要插入一行，因为目标数据库中少了一个作者。总共需要更新四行，因为我们在同一张表中删除了`phone`列。'
- en: We can now click on **Apply Selected Changes** button. The **Would you like
    to delete..**. checkbox does not apply to this operation.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以点击**应用所选更改**按钮。**您想删除..**复选框不适用于此操作。
- en: 'We now see that the upper part of the screen proposes fewer changes to make:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们看到屏幕上部提出了更少的更改：
- en: '![Performing a selective synchronization](img/7782_13_10.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![执行选择性同步](img/7782_13_10.jpg)'
- en: We can go on by selecting structure or data changes and then applying them in
    the order we deem appropriate.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以继续选择结构或数据更改，然后按照我们认为合适的顺序应用它们。
- en: This concludes the section describing the synchronization feature. We continue
    with coverage of replication support.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 这结束了描述同步功能的部分。我们将继续介绍复制支持。
- en: Supporting MySQL replication
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 支持MySQL复制
- en: 'In the *Preparing for replication* section, we saw an overview of MySQL replication.
    In this section, we cover the following topics:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在*为复制做准备*部分，我们看到了MySQL复制的概述。在本节中，我们将涵盖以下主题：
- en: How we can use phpMyAdmin to configure replication
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们如何使用phpMyAdmin来配置复制
- en: How to prepare a test environment containing one master server and two slave
    servers
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何准备一个包含一个主服务器和两个从服务器的测试环境
- en: How to send commands to control the servers
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何发送命令来控制服务器
- en: How to obtain information on replication for servers, databases, and tables
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何获取有关服务器、数据库和表的复制信息
- en: phpMyAdmin's interface offers a **Replication** page; however, other pages contain
    either information about replication or links to control replication actions.
    We will point to each appropriate location when covering the related subject.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: phpMyAdmin的界面提供了一个**复制**页面；然而，其他页面包含有关复制的信息或控制复制操作的链接。在涉及相关主题时，我们将指出每个适当的位置。
- en: How to use this section depends on how many servers we have at our disposal.
    If we have at least two servers and want to configure them via phpMyAdmin in a
    master/slave relationship, we can follow the *Configuring replication* section.
    If instead we only have one server to play with, then we should take advice from
    the *Setting up a test environment* section to install many instances of the MySQL
    server on the same machine.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 如何使用这一部分取决于我们手头有多少服务器。如果我们至少有两台服务器，并且想通过phpMyAdmin在主/从关系中配置它们，我们可以按照*配置复制*部分的步骤。如果我们只有一台服务器可以使用，那么我们应该从*设置测试环境*部分中获取建议，在同一台机器上安装多个MySQL服务器实例。
- en: The Replication menu
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 复制菜单
- en: In `Server` view, the **Replication** menu is only shown to privileged users,
    such as the MySQL root user. When a server is already configured as a master server
    or a slave server (or both), the **Replication** page is used to display status
    information and provide links that send commands.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 在`服务器`视图中，**复制**菜单只显示给特权用户，如MySQL根用户。当服务器已经配置为主服务器或从服务器（或两者兼有）时，**复制**页面用于显示状态信息并提供发送命令的链接。
- en: Configuring replication
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置复制
- en: For this exercise, we assume that the server does not currently occupy the role
    of master or slave server. phpMyAdmin cannot directly configure all aspects of
    MySQL replication. The reason is that, contrary to manipulating database structure
    and data by sending queries to the MySQL server, replication configuration consists
    (in part) of command lines stored in a MySQL configuration file, often named `my.cnf`.
    phpMyAdmin, being a web application, does not have access to this file. This is
    how the MySQL server's developers intended the configuration to be—at a configuration
    file level.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个练习，我们假设服务器目前不占据主服务器或从服务器的角色。phpMyAdmin不能直接配置MySQL复制的所有方面。原因是，与通过向MySQL服务器发送查询来操作数据库结构和数据不同，复制配置包括（部分）存储在MySQL配置文件中的命令行，通常命名为`my.cnf`。作为一个Web应用程序，phpMyAdmin无法访问这个文件。这是MySQL服务器开发人员打算的配置方式——在配置文件级别上。
- en: The best that phpMyAdmin can do in this situation is to guide us by generating
    (on screen) the proper command lines in reaction to our preferences, then it's
    up to us to copy these lines where they need to go and to restart the server(s).
    phpMyAdmin cannot even read the current replication configuration lines; it can
    only deduce server status via some `SHOW` commands.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，phpMyAdmin能做的最好的就是通过根据我们的偏好生成（在屏幕上）正确的命令行来指导我们，然后由我们将这些行复制到它们需要去的地方并重新启动服务器。phpMyAdmin甚至不能读取当前的复制配置行；它只能通过一些`SHOW`命令推断服务器状态。
- en: 'Let us enter the **Replication** menu and see what happens:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们进入“复制”菜单，看看会发生什么：
- en: '![Configuring replication](img/7782_13_11.jpg)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![配置复制](img/7782_13_11.jpg)'
- en: Master server configuration
  id: totrans-90
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 主服务器配置
- en: 'Now we choose to configure the server as a master by clicking on the appropriate
    **configure** link. The panel that appears gives us a thorough advice:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们选择通过点击适当的“配置”链接将服务器配置为主服务器。出现的面板给了我们详细的建议：
- en: '![Master server configuration](img/7782_13_12.jpg)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![主服务器配置](img/7782_13_12.jpg)'
- en: 'The first paragraph confirms that this server is not configured as a master
    in a replication process. We want to achieve this configuration, but first we
    need to think about the kind of replication we want. Should all databases be replicated,
    except for some of them? Or do we want the opposite? A convenient drop-down list
    offers us these choices:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 第一段确认了这个服务器目前没有配置为复制过程中的主服务器。我们想要实现这个配置，但首先我们需要考虑我们想要的复制类型。所有数据库都应该被复制，除了其中一些吗？还是我们想要相反的？一个方便的下拉列表为我们提供了这些选择：
- en: '**Replicate all databases; Ignore:**'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**复制所有数据库；忽略：**'
- en: '**Ignore all databases; Replicate:**'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**忽略所有数据库；复制：**'
- en: 'The first choice (which is the default) implies that, in general, all databases
    are replicated; we don''t even have to enumerate them in the configuration file.
    In this case, the databases selector is used to specify which database we want
    to exclude from the replication process. Let us pick up the **mysql** database
    and see what happens in our JavaScript-enabled browser:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个选择（默认）意味着一般情况下所有数据库都被复制；我们甚至不需要在配置文件中列举它们。在这种情况下，数据库选择器用于指定我们想要从复制过程中排除的数据库。让我们选择“mysql”数据库，看看在我们启用JavaScript的浏览器中会发生什么：
- en: '![Master server configuration](img/7782_13_13.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![主服务器配置](img/7782_13_13.jpg)'
- en: We notice that a line appeared, stating `binlog_ignore_db=mysql`. This is a
    MySQL server instruction (not a SQL statement) that tells the server to ignore
    sending transactions about this database to the binary log. Let us examine the
    meaning of the other lines. The `server-id` is a unique ID generated by phpMyAdmin;
    each server that participates in replication must have a unique server ID. Therefore,
    we either track the server IDs by hand, ensuring their uniqueness, or we simply
    use the number randomly generated by phpMyAdmin. We also see the `log-bin` and
    `log-error` instructions; in fact, binary logging is mandatory in order for any
    replication to occur.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 我们注意到出现了一行，说明`binlog_ignore_db=mysql`。这是一个MySQL服务器指令（而不是SQL语句），告诉服务器忽略将关于这个数据库的事务发送到二进制日志。让我们来解释其他行的含义。`server-id`是由phpMyAdmin生成的唯一ID；参与复制的每个服务器都必须有一个唯一的服务器ID。因此，我们要么手动跟踪服务器ID，确保它们的唯一性，要么简单地使用phpMyAdmin随机生成的数字。我们还看到了`log-bin`和`log-error`指令；实际上，为了进行任何复制，二进制日志记录是强制性的。
- en: We could add other database names to the list by using *Ctrl* + Click or *Command*
    + Click, depending on our workstation's OS. However, all that phpMyAdmin does
    is to generate correct lines; to make them operational, we still need to follow
    the given advice and paste these lines at the end of the `[mysqld]` section of
    our MySQL configuration file. We should then restart the MySQL server process—the
    way to do this depends on our environment.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过使用*Ctrl* + 点击或*Command* + 点击在列表中添加其他数据库名称，具体取决于我们工作站的操作系统。然而，phpMyAdmin所做的只是生成正确的行；要使它们生效，我们仍然需要遵循给定的建议，并将这些行粘贴到我们的MySQL配置文件的`[mysqld]`部分的末尾。然后我们应该重新启动MySQL服务器进程——如何做这取决于我们的环境。
- en: 'After our server has been restarted, we go back to the **Replication** menu;
    at this point, we see a different panel regarding the master:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的服务器重新启动后，我们回到“复制”菜单；此时，我们会看到关于主服务器的不同面板：
- en: '![Master server configuration](img/7782_13_14.jpg)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![主服务器配置](img/7782_13_14.jpg)'
- en: We can use the **Show master status** link to get some information about the
    master, including the current binary log name and position, and information on
    which databases to replicate or to ignore, as specified previously.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用“显示主服务器状态”链接来获取有关主服务器的一些信息，包括当前的二进制日志名称和位置，以及先前指定的要复制或忽略的数据库的信息。
- en: The **Show connected slaves** link would report nothing currently, as no slave
    is yet connected to this master.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: “显示已连接的从服务器”链接目前不会报告任何内容，因为还没有从服务器连接到这个主服务器。
- en: 'Now would be the time to use the **Add slave replication user** link, because
    this master needs to have a separate account dedicated to replication. The slaves
    will use this account created on the master to connect to it. Clicking on this
    link displays the following panel, in which a user account, **replic**, is being
    created with a password of our choosing:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 现在是使用“添加从服务器复制用户”链接的时候了，因为这个主服务器需要有一个专门用于复制的单独账户。从服务器将使用在主服务器上创建的这个账户来连接到它。点击这个链接会显示以下面板，其中正在创建一个名为“replic”的用户账户，密码由我们选择：
- en: '![Master server configuration](img/7782_13_15.jpg)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![主服务器配置](img/7782_13_15.jpg)'
- en: After clicking on **Go**, phpMyAdmin takes care of creating this user with the
    correct permissions set.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 点击“Go”后，phpMyAdmin会负责创建这个用户并设置正确的权限。
- en: Slave server configuration
  id: totrans-107
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从服务器配置
- en: 'Now, on the machine that will act as a slave server in the replication process,
    we start phpMyAdmin. In the **Replication** menu, we click on **configure** in
    the following dialog:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，在将作为复制过程中从服务器的机器上，我们启动phpMyAdmin。在“复制”菜单中，我们点击以下对话框中的“配置”：
- en: '![Slave server configuration](img/7782_13_16.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![从服务器配置](img/7782_13_16.jpg)'
- en: 'The slave server configuration panel appears, as shown in the following screenshot:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 从服务器配置面板显示如下截图所示：
- en: '![Slave server configuration](img/7782_13_17.jpg)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![从服务器配置](img/7782_13_17.jpg)'
- en: As with the master configuration, we get a suggestion about having a unique
    server ID in the configuration file for the slave, and we should follow this advice.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 与主配置一样，我们在从服务器的配置文件中得到了关于在配置文件中具有唯一服务器ID的建议，我们应该遵循这个建议。
- en: In this panel, we enter the username and password of the dedicated replication
    account we created on the master. We also have to indicate the hostname and port
    number corresponding to the master server. After filling this panel and clicking
    on **Go**, phpMyAdmin sends the appropriate `CHANGE MASTER` command to the slave,
    which puts this server in slave mode.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 在此面板中，我们输入在主服务器上创建的专用复制帐户的用户名和密码。我们还必须指示与主服务器对应的主机名和端口号。在填写此面板并单击“Go”后，phpMyAdmin将向从服务器发送适当的`CHANGE
    MASTER`命令，将此服务器置于从服务器模式。
- en: Setting up a test environment
  id: totrans-114
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置测试环境
- en: 'The replication process occurs between at least two instances of the MySQL
    server. In production, this normally implies a minimum of two physical servers
    to procure these benefits:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 复制过程发生在至少两个MySQL服务器实例之间。在生产中，这通常意味着至少需要两台物理服务器来获得这些好处：
- en: Better performance
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更好的性能
- en: Increased redundancy
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 增加冗余
- en: However, due to MySQL's configurable port number (the default being 3306), data
    directory, and socket, it's possible to have more than one MySQL instance on the
    same server. This setup can be configured manually, or via an installation system
    such as the MySQL Sandbox. This is an open source project located at [http://mysqlsandbox.net](http://mysqlsandbox.net).
    With this tool, we can set up one or many MySQL servers very quickly. By using
    the powerful `make_replication_sandbox` Linux shell command, we can install an
    environment that consists of one master server and two slave servers. Each server
    can be started or stopped individually.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，由于MySQL的可配置端口号（默认为3306）、数据目录和套接字，可能在同一台服务器上有多个MySQL实例。此设置可以手动配置，也可以通过安装系统（如MySQL
    Sandbox）进行配置。这是一个位于[http://mysqlsandbox.net](http://mysqlsandbox.net)的开源项目。使用这个工具，我们可以非常快速地设置一个或多个MySQL服务器。通过使用强大的`make_replication_sandbox`
    Linux shell命令，我们可以安装一个包含一个主服务器和两个从服务器的环境。每个服务器可以单独启动或停止。
- en: 'The following exercises assume that the MySQL Sandbox has been installed on
    your server and that phpMyAdmin''s `config.inc.php` contains a reference to these
    Sandbox servers, as shown in the following code block (please adjust the socket
    names to your own environment):'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 以下练习假定MySQL Sandbox已安装在您的服务器上，并且phpMyAdmin的`config.inc.php`包含对这些Sandbox服务器的引用，如下面的代码块所示（请根据自己的环境调整套接字名称）：
- en: '[PRE0]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Here, we use the `$cfg[''Servers''][$i][''verbose'']` directive to give a unique
    name to each instance, as the real server name is `localhost` for all of these
    instances. Each Sandbox server initially contains two databases: `mysql` and `test`.'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们使用`$cfg['Servers'][$i]['verbose']`指令为每个实例提供一个唯一的名称，因为所有这些实例的真实服务器名称都是`localhost`。每个Sandbox服务器最初包含两个数据库：`mysql`和`test`。
- en: Controlling a slave server
  id: totrans-122
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 控制从服务器
- en: 'Here we will assume that the Sandbox testing environment has been set. However,
    the explanations are useful for all situations in which we have a slave server.
    After connecting to a slave and once again opening the **Replication** menu, we
    see:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们假设Sandbox测试环境已经设置。但是，这些解释对于所有具有从服务器的情况都是有用的。连接到从服务器并再次打开“复制”菜单后，我们看到：
- en: '![Controlling a slave server](img/7782_13_18.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![控制从服务器](img/7782_13_18.jpg)'
- en: 'The following options are available:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 有以下选项可用：
- en: The **See slave status table** link permits us to receive information about
    all the system variables related to replication for this slave server.
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “查看从服务器状态表”链接允许我们接收有关此从服务器复制相关的所有系统变量的信息。
- en: 'The **Control slave:** link reveals more options; some of them can toggle between
    the stop and start condition:'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “控制从服务器：”链接显示更多选项；其中一些可以在停止和启动条件之间切换。
- en: The **Full stop** option is used to stop both the IO thread (the part of the
    MySQL server responsible for receiving updates from the master and writing them
    to the slave's relay log) and the SQL thread (which reads the updates from the
    relay log and executes them)
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “全面停止”选项用于停止IO线程（负责从主服务器接收更新并将其写入从服务器的中继日志的MySQL服务器的一部分）和SQL线程（从中继日志读取更新并执行它们）
- en: The **Reset slave** option stops the slave, sends a `RESET SLAVE` command that
    causes it to forget its replication position in the master's binary log, and then
    restarts the slave
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “重置从服务器”选项停止从服务器，发送`RESET SLAVE`命令导致其忘记在主服务器的二进制日志中的复制位置，然后重新启动从服务器
- en: The **SQL Thread Stop only** option and **IO Thread Stop only** option are used
    to stop just the respective thread
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “仅停止SQL线程”选项和“仅停止IO线程”选项用于仅停止各自的线程
- en: The **Error management:** link permits to tell the slave server to skip some
    of the events (updates) sent from the master. For more details, please refer to
    [http://dev.mysql.com/doc/refman/5.1/en/set-global-sql-slave-skip-counter.html](http://dev.mysql.com/doc/refman/5.1/en/set-global-sql-slave-skip-counter.html).
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 错误管理：链接允许告诉从服务器跳过主服务器发送的一些事件（更新）。有关更多详细信息，请参阅[http://dev.mysql.com/doc/refman/5.1/en/set-global-sql-slave-skip-counter.html](http://dev.mysql.com/doc/refman/5.1/en/set-global-sql-slave-skip-counter.html)。
- en: The **Change or reconfigure master server** link could be used to specify that
    this slave server should now receive updates from a different master.
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更改或重新配置主服务器：链接可用于指定此从服务器现在应该接收来自不同主服务器的更新。
- en: Obtaining replication information
  id: totrans-133
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 获取复制信息
- en: Apart from the **Replication** menu, other screens in phpMyAdmin inform us about
    replication-related items. These screens are not found with the other replication
    dialogs; rather they are scattered on various pages, where they display replication
    information in the context of the respective pages.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 除了**复制**菜单之外，phpMyAdmin的其他屏幕也会向我们提供有关复制的信息。这些屏幕在其他复制对话框中找不到；相反，它们分散在各个页面上，在相应页面的上下文中显示复制信息。
- en: Gathering replication status
  id: totrans-135
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 收集复制状态
- en: 'By entering the **Status** panel in `Server` view, we first get a brief message,
    for example:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 通过进入`服务器`视图中的**状态**面板，我们首先会得到一个简短的消息，例如：
- en: '"This MySQL server works as master in replication process. For further information
    about replication status on the server, please visit the replication section."'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: “这个MySQL服务器在复制过程中作为主服务器工作。有关服务器复制状态的更多信息，请访问复制部分。”
- en: There are a few **Replication** links on this page that show us the status variables
    of either the master or slave servers, and some links to get information about
    how many slave hosts are connected and the status of replication in general.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个页面上有一些**复制**链接，它们向我们展示了主服务器或从服务器的状态变量，以及一些关于连接的从服务器主机数量和复制状态的信息。
- en: Replicated databases
  id: totrans-139
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 已复制的数据库
- en: 'On the master server, having a look at the **Databases** menu in `Server` view
    shows us that some databases can potentially be replicated, with a green checkmark
    in the **Master replication** column:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在主服务器上，查看`服务器`视图中的**数据库**菜单会显示一些数据库可能会被复制，**主复制**列中会有一个绿色的勾号：
- en: '![Replicated databases](img/7782_13_19.jpg)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![已复制的数据库](img/7782_13_19.jpg)'
- en: This is because this server is configured with a binary log and these databases
    are not excluded from replication.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 这是因为这台服务器配置了二进制日志，而这些数据库没有被排除在复制之外。
- en: 'As we have the following line of code in the `[mysqld]` section within the
    master''s configuration file, we can exclude from the binary log all transactions
    that affect the `mysql` database:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们在主服务器的配置文件的`[mysqld]`部分中有以下代码行，我们可以排除影响`mysql`数据库的所有事务不记录到二进制日志中：
- en: '[PRE1]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Therefore, the output of the **Databases** page shows a red icon next to the
    `mysql` database.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，**数据库**页面的输出显示了`mysql`数据库旁边的红色图标。
- en: If this is a slave server, a **Server replication** column is shown.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这是一个从服务器，将显示一个**服务器复制**列。
- en: Tip
  id: totrans-147
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Note that a slave server can itself have a binary log; therefore, in this case,
    both **Master replication** and **Slave replication** columns are shown. This
    means that this slave could in turn be a master server for another slave server.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，从服务器本身可以有一个二进制日志；因此，在这种情况下，**主复制**和**从复制**列都会显示出来。这意味着这个从服务器可以成为另一个从服务器的主服务器。
- en: Replicated tables
  id: totrans-149
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 已复制的表
- en: 'Let us suppose that on the master server, we create a table named `employee`
    in the `test` database. At this point, replication does its magic and we can have
    a look at the `test` database on a slave server:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 假设在主服务器上，我们在`test`数据库中创建了一个名为`employee`的表。此时，复制会发挥其魔力，我们可以在从服务器上查看`test`数据库：
- en: '![Replicated tables](img/7782_13_20.jpg)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![已复制的表](img/7782_13_20.jpg)'
- en: Here, the **Replication** column is shown as a reminder. We should not modify
    this table on the slave server directly, because its existence is for replication
    purpose only. If we decide to alter it directly, our changes will be done only
    in this table, introducing inconsistencies between the master and this slave,
    which is not a good idea.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，**复制**列显示为提醒。我们不应该直接在从服务器上修改这个表，因为它的存在只是为了复制目的。如果我们决定直接修改它，我们的更改只会在这个表中进行，导致主服务器和从服务器之间的不一致，这不是一个好主意。
- en: Summary
  id: totrans-153
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we learnt how to synchronize both the structure and data from
    one database to another, on the same server or on different servers. We covered
    the goals of synchronization and how to perform a complete or selective synchronization.
    We then examined how to use phpMyAdmin to guide us into replication setup, including
    a master and a slave server; how to prepare a test environment using the MySQL
    Sandbox, and how to control the slave servers.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了如何将一个数据库的结构和数据同步到另一个数据库，无论是在同一台服务器上还是在不同的服务器上。我们涵盖了同步的目标以及如何执行完整或选择性的同步。然后我们研究了如何使用phpMyAdmin来引导我们进行复制设置，包括主服务器和从服务器；如何使用MySQL
    Sandbox准备测试环境，以及如何控制从服务器。
- en: The next chapter will show you how to keep permanent bookmarks of your queries.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章将向您展示如何保留您的查询的永久书签。
